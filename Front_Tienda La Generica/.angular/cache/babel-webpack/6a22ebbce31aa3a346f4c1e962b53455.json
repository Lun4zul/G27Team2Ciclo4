{"ast":null,"code":"import _classCallCheck from \"C:/Users/Andres Lozada/Documents/ANDRES/MINTIC 2022/GITHUB/G27Team2Ciclo4/Front_Tienda La Generica/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/Andres Lozada/Documents/ANDRES/MINTIC 2022/GITHUB/G27Team2Ciclo4/Front_Tienda La Generica/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { __decorate, __metadata } from \"tslib\";\nimport { HttpClient } from '@angular/common/http';\nimport { Component } from '@angular/core';\nimport { ToastrService } from 'ngx-toastr';\n\nvar VentasComponent = /*#__PURE__*/function () {\n  function VentasComponent(clientehttp, toastr) {\n    _classCallCheck(this, VentasComponent);\n\n    this.clientehttp = clientehttp;\n    this.toastr = toastr;\n    this.apiURL = \"http://localhost:8080/api/\";\n    this.totalventa = 0.0;\n    this.totalplusiva = 0.0;\n    this.totaliva = 0.0;\n    this.listadetalleventa = Array();\n    this.ciudad = '0';\n  }\n\n  _createClass(VentasComponent, [{\n    key: \"getConsecutivo\",\n    value: function getConsecutivo() {\n      var _this = this;\n\n      this.clientehttp.get(this.apiURL + \"ventas/consecutivo\").subscribe(function (data) {\n        _this.consecutivo = data;\n        _this.consecutivo++;\n        console.log(_this.consecutivo);\n      });\n    }\n  }, {\n    key: \"getCliente\",\n    value: function getCliente() {\n      var _this2 = this;\n\n      this.clientehttp.get(this.apiURL + \"clientes/cedula/\" + this.cedulacliente).subscribe(function (data) {\n        _this2.clientedata = data;\n        console.log(_this2.clientedata);\n      });\n    }\n  }, {\n    key: \"getProducto\",\n    value: function getProducto(numproducto) {\n      var _this3 = this;\n\n      switch (numproducto) {\n        case 1:\n          this.clientehttp.get(this.apiURL + \"productos/codigo/\" + this.codprod1).subscribe(function (data) {\n            _this3.product1 = data;\n            console.log(_this3.product1);\n          });\n          break;\n\n        case 2:\n          this.clientehttp.get(this.apiURL + \"productos/codigo/\" + this.codprod2).subscribe(function (data) {\n            _this3.product2 = data;\n            console.log(_this3.product2);\n          });\n          break;\n\n        case 3:\n          this.clientehttp.get(this.apiURL + \"productos/codigo/\" + this.codprod3).subscribe(function (data) {\n            _this3.product3 = data;\n            console.log(_this3.product3);\n          });\n          break;\n\n        default:\n          break;\n      }\n    }\n  }, {\n    key: \"calcPrecioProd\",\n    value: function calcPrecioProd(numproducto) {\n      switch (numproducto) {\n        case 1:\n          this.precioprod1 = this.cant1 * this.product1[0].precioventa;\n          break;\n\n        case 2:\n          this.precioprod2 = this.cant2 * this.product2[0].precioventa;\n          break;\n\n        case 3:\n          this.precioprod3 = this.cant3 * this.product3[0].precioventa;\n          break;\n\n        default:\n          break;\n      }\n\n      ;\n      this.calcularTotales();\n    }\n  }, {\n    key: \"calcularTotales\",\n    value: function calcularTotales() {\n      this.totalventa = 0.0;\n\n      if (this.precioprod1 != null && this.precioprod1 != undefined && this.precioprod1 != \"\") {\n        this.totalventa += this.precioprod1;\n        this.totaliva = this.totalventa * 0.19;\n        this.totalplusiva = this.totalventa + this.totalventa * 0.19;\n      }\n\n      if (this.precioprod2 != null && this.precioprod2 != undefined && this.precioprod2 != \"\") {\n        this.totalventa += this.precioprod2;\n        this.totaliva = this.totalventa * 0.19;\n        this.totalplusiva = this.totalventa + this.totalventa * 0.19;\n      }\n\n      if (this.precioprod3 != null && this.precioprod3 != undefined && this.precioprod3 != \"\") {\n        this.totalventa += this.precioprod3;\n        this.totaliva = this.totalventa * 0.19;\n        this.totalplusiva = this.totalventa + this.totalventa * 0.19;\n      }\n    }\n  }, {\n    key: \"postVenta\",\n    value: function postVenta() {\n      var _this4 = this;\n\n      if (this.precioprod1 != null && this.precioprod1 != undefined && this.precioprod1 != \"\") {\n        var aux = {\n          \"cantidadProducto\": this.cant1,\n          \"codigoProducto\": this.codprod1,\n          \"ivaVenta\": this.precioprod1 * 0.19,\n          \"totalVenta\": this.precioprod1,\n          \"totalVentaConIva\": this.precioprod1 * 0.19 + this.precioprod1\n        };\n        this.listadetalleventa.push(aux);\n      }\n\n      if (this.precioprod2 != null && this.precioprod2 != undefined && this.precioprod2 != \"\") {\n        var _aux = {\n          \"cantidadProducto\": this.cant2,\n          \"codigoProducto\": this.codprod2,\n          \"ivaVenta\": this.precioprod2 * 0.19,\n          \"totalVenta\": this.precioprod2,\n          \"totalVentaConIva\": this.precioprod2 * 0.19 + this.precioprod2\n        };\n        this.listadetalleventa.push(_aux);\n      }\n\n      if (this.precioprod3 != null && this.precioprod3 != undefined && this.precioprod3 != \"\") {\n        var _aux2 = {\n          \"cantidadProducto\": this.cant3,\n          \"codigoProducto\": this.codprod3,\n          \"ivaVenta\": this.precioprod3 * 0.19,\n          \"totalVenta\": this.precioprod3,\n          \"totalVentaConIva\": this.precioprod3 * 0.19 + this.precioprod3\n        };\n        this.listadetalleventa.push(_aux2);\n      }\n\n      this.clientehttp.post(this.apiURL + \"ventas\", {\n        \"cedulaCliente\": this.cedulacliente,\n        \"codigoVenta\": this.consecutivo,\n        \"detalleventa\": this.listadetalleventa,\n        \"ivaVenta\": this.totaliva,\n        \"totalVenta\": this.totalplusiva,\n        \"totalVentaConIva\": this.totalventa\n      }, {\n        observe: 'response'\n      }).subscribe(function (response) {\n        _this4.codigorespuesta = response.status;\n\n        switch (_this4.codigorespuesta) {\n          case 201:\n            _this4.postConsolidado();\n\n            _this4.showNotification('top', 'right', 1);\n\n            break;\n\n          case 226:\n            _this4.showNotification('top', 'right', 2);\n\n            break;\n\n          case 500:\n            _this4.showNotification('top', 'right', 3);\n\n            break;\n        }\n      });\n    }\n  }, {\n    key: \"postConsolidado\",\n    value: function postConsolidado() {\n      console.log(this.ciudad);\n      console.log(typeof this.ciudad);\n      this.clientehttp.post(this.apiURL + \"consolidados/agregar/\" + this.ciudad, {}, {\n        observe: \"response\"\n      }).subscribe(function (response) {\n        console.log(response.status);\n      });\n    }\n  }, {\n    key: \"showNotification\",\n    value: function showNotification(from, align, type) {\n      switch (type) {\n        case 1:\n          this.toastr.success('<b>Dato creado con exito</b>', '', {\n            disableTimeOut: false,\n            closeButton: true,\n            enableHtml: true,\n            toastClass: 'alert alert-success alert-with-icon',\n            positionClass: 'toast-' + from + '-' + align\n          });\n          break;\n\n        case 2:\n          this.toastr.warning('<b>El dato se encuentra duplicado', '', {\n            disableTimeOut: false,\n            enableHtml: true,\n            closeButton: true,\n            toastClass: 'alert alert-danger alert-with-icon',\n            positionClass: 'toast-' + from + '-' + align\n          });\n          break;\n\n        case 3:\n          this.toastr.error('<b>Error del servidor', '', {\n            disableTimeOut: false,\n            enableHtml: true,\n            closeButton: true,\n            toastClass: 'alert alert-danger alert-with-icon',\n            positionClass: 'toast-' + from + '-' + align\n          });\n          break;\n      }\n    }\n  }, {\n    key: \"reload\",\n    value: function reload() {\n      window.location.reload();\n    }\n  }, {\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      this.clientedata = {\n        \"nombrecliente\": \"\"\n      };\n      this.product1 = [{\n        \"nombreproducto\": \"\"\n      }];\n      this.product2 = [{\n        \"nombreproducto\": \"\"\n      }];\n      this.product3 = [{\n        \"nombreproducto\": \"\"\n      }];\n      this.getConsecutivo();\n    }\n  }]);\n\n  return VentasComponent;\n}();\n\nVentasComponent = __decorate([Component({\n  selector: 'app-ventas',\n  templateUrl: './ventas.component.html',\n  styleUrls: ['./ventas.component.scss']\n}), __metadata(\"design:paramtypes\", [HttpClient, ToastrService])], VentasComponent);\nexport { VentasComponent };","map":null,"metadata":{},"sourceType":"module"}